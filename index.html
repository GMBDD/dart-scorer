<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dart Scorer 301</title>

<style>
body { 
  font-family: Arial, sans-serif; 
  background:#111; 
  color:white; 
  text-align:center; 
  margin:0;
}

h2 { margin-top:20px; }

button { 
  padding:10px; 
  margin:5px; 
  font-size:16px; 
  cursor:pointer;
}

select, input {
  padding:8px;
  margin:5px;
  font-size:16px;
}

.player { 
  border:1px solid #444; 
  margin:10px; 
  padding:10px; 
  border-radius:8px;
}

.active { 
  border:2px solid lime; 
}

.score {
  font-size:32px;
  font-weight:bold;
}
</style>
</head>

<body>

<h2>ðŸŽ¯ Dart Scorer 301</h2>

<div id="setup">
Spieler (1-6):
<select id="playerCount">
<option>1</option>
<option selected>2</option>
<option>3</option>
<option>4</option>
<option>5</option>
<option>6</option>
</select>

Double In:
<select id="doubleIn">
<option value="true">AN</option>
<option value="false">AUS</option>
</select>

Out:
<select id="outMode">
<option value="double">Double Out</option>
<option value="straight">Straight Out</option>
</select>

<br><br>
<button onclick="startGame()">Start</button>
</div>

<div id="game"></div>

<script>

let players = [];
let current = 0;
let doubleIn = true;
let outMode = "double";

function startGame() {
  const count = parseInt(document.getElementById("playerCount").value);
  doubleIn = document.getElementById("doubleIn").value === "true";
  outMode = document.getElementById("outMode").value;

  players = [];

  for(let i=0;i<count;i++){
    players.push({
      score:301,
      opened:!doubleIn,
      won:false
    });
  }

  current = 0;
  render();
}

function render(){
  let html = "";

  players.forEach((p,i)=>{
    html += `
    <div class="player ${i===current?'active':''}">
      <h3>Spieler ${i+1} ${p.won?'âœ…':''}</h3>
      <div class="score">${p.score}</div>
      <input type="number" id="input${i}" placeholder="Punkte (0-180)" ${i!==current||p.won?'disabled':''}>
      <button onclick="submitScore(${i})" ${i!==current||p.won?'disabled':''}>OK</button>
    </div>
    `;
  });

  document.getElementById("game").innerHTML = html;
}

function submitScore(i){
  const val = parseInt(document.getElementById("input"+i).value);
  if(isNaN(val) || val < 0 || val > 180) return;

  const p = players[i];

  // Double-In
  if(!p.opened){
    if(val % 2 === 0 && val > 0){
      p.opened = true;
    } else {
      nextPlayer();
      render();
      return;
    }
  }

  let newScore = p.score - val;

  // Bust
  if(newScore < 0 || (outMode === "double" && newScore === 1)){
    nextPlayer();
    render();
    return;
  }

  // Checkout
  if(newScore === 0){
    if(outMode === "double" && val % 2 !== 0){
      nextPlayer();
      render();
      return;
    }
    p.score = 0;
    p.won = true;
  } else {
    p.score = newScore;
  }

  nextPlayer();
  render();
}

function nextPlayer(){
  do{
    current = (current + 1) % players.length;
  } while(players[current].won);
}

</script>

</body>
</html>
