<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Darts Scoring</title>

<style>
:root{
  --bg:#0f0f12; --card:#17171c; --text:#f2f2f2; --muted:#a7a7b0; --line:#2a2a33;
  --btn:#121218; --btn2:#1c1c24; --accent:#3a3a44; --ok:#bfffc0; --bad:#ffb3b3;
}
*{box-sizing:border-box}
body{font-family:Arial,sans-serif;background:var(--bg);color:var(--text);margin:0}
header{
  padding:12px;border-bottom:1px solid var(--line);
  display:flex;justify-content:center;flex-wrap:wrap;gap:10px;align-items:center
}
header strong{font-size:16px}
button,select,input{
  padding:10px 14px;font-size:16px;border-radius:12px;border:1px solid var(--line);
  background:var(--btn);color:var(--text);cursor:pointer
}
.wrap{max-width:1200px;margin:0 auto;padding:14px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:12px}
.layout{display:grid;grid-template-columns:1fr 520px;gap:12px}
.playerList{display:flex;flex-direction:column;gap:8px;margin-top:10px}
.playerItem{display:flex;justify-content:space-between;padding:10px;border:1px solid var(--line);border-radius:12px;background:#101016}
.playerItem.active{outline:2px solid var(--accent)}
.pScore{font-size:28px;font-weight:900}
.keypadCard{position:fixed;left:12px;right:12px;bottom:12px;z-index:50}
.bigScore{font-size:44px;font-weight:900;text-align:center}
.dartRow{display:flex;gap:8px;justify-content:center;margin:10px 0}
.dartBox{min-width:90px;padding:10px;border-radius:12px;border:1px solid var(--line);background:#0f0f14;text-align:center}
.modes{display:flex;gap:8px;justify-content:center;margin-bottom:10px}
.modeBtn.active{outline:2px solid var(--accent)}
.nums{display:grid;gap:8px;grid-template-columns:repeat(4,1fr);max-width:520px;margin:0 auto 10px}
.specials{display:flex;gap:8px;justify-content:center;margin-bottom:10px}
.actions{display:flex;gap:8px;justify-content:center}
</style>
</head>

<body>

<header>
<strong>üéØ Darts Scoring</strong>

<span>Start:</span>
<select id="startScore">
<option value="301" selected>301</option>
<option value="501">501</option>
<option value="701">701</option>
<option value="1001">1001</option>
</select>

<span>Spieler:</span>
<select id="playerCount">
<option>1</option>
<option selected>2</option>
<option>3</option>
<option>4</option>
<option>5</option>
<option>6</option>
</select>

<span>IN:</span>
<select id="doubleIn">
<option value="false" selected>AUS</option>
<option value="true">AN</option>
</select>

<span>OUT:</span>
<select id="outMode">
<option value="false" selected>AUS</option>
<option value="true">AN</option>
</select>

<span>Auto-OK:</span>
<select id="autoOk">
<option value="true" selected>AN</option>
<option value="false">AUS</option>
</select>

<button id="startBtn">Neues Spiel</button>
<button id="randomStartBtn">üé≤ Start</button>
<button id="undoBtn">Undo</button>
</header>

<div class="wrap">

<div class="layout">

<div class="card">
<div id="playerList" class="playerList"></div>
</div>

<div class="card keypadCard">

<div style="text-align:center;font-weight:900" id="currentName"></div>
<div class="bigScore" id="currentScore"></div>

<div class="dartRow">
<div class="dartBox" id="d0">‚Äî</div>
<div class="dartBox" id="d1">‚Äî</div>
<div class="dartBox" id="d2">‚Äî</div>
</div>

<div class="modes">
<button class="modeBtn" id="mS">Single</button>
<button class="modeBtn" id="mD">Double</button>
<button class="modeBtn" id="mT">Triple</button>
</div>

<div class="nums" id="nums"></div>

<div class="specials">
<button onclick="pickSpecial(25)">25</button>
<button onclick="pickSpecial(50)">BULL</button>
<button onclick="pickSpecial(0)">MISS</button>
</div>

<div class="actions">
<button onclick="undoDart()">‚Üê</button>
<button onclick="clearTurn()">C</button>
<button onclick="submitTurn()">OK</button>
</div>

</div>

</div>
</div>

<script>

const $ = id => document.getElementById(id);

let state = {
startScore:301,
playerCount:2,
doubleIn:false,
doubleOut:false,
autoOk:true,

players:[],
current:0,
mode:"S",
darts:[null,null,null],
dartIdx:0,
history:[]
};

function newPlayer(name){
return {
name,
score:state.startScore,
opened:!state.doubleIn,
won:false
};
}

function startGame(){

state.startScore=parseInt($("startScore").value);
state.playerCount=parseInt($("playerCount").value);
state.doubleIn=$("doubleIn").value==="true";
state.doubleOut=$("outMode").value==="true";
state.autoOk=$("autoOk").value==="true";

state.players=[];

for(let i=0;i<state.playerCount;i++){
state.players.push(newPlayer("Spieler "+(i+1)));
}

state.current=0;
resetTurn();
renderAll();
}

function resetTurn(){
state.mode="S";
state.darts=[null,null,null];
state.dartIdx=0;
}

function renderAll(){
renderPlayers();
renderKeypad();
}

function renderPlayers(){

let html="";

state.players.forEach((p,i)=>{
html+=`
<div class="playerItem ${i===state.current?"active":""}">
<div>${p.name}</div>
<div class="pScore">${p.score}</div>
</div>`;
});

$("playerList").innerHTML=html;

let p=state.players[state.current];
$("currentName").textContent=p.name;
$("currentScore").textContent=p.score;
}

function renderKeypad(){

for(let i=0;i<3;i++){
$("d"+i).textContent=state.darts[i]?.label || "‚Äî";
}

if(!$("nums").dataset.built){
$("nums").dataset.built=1;
for(let n=1;n<=20;n++){
let b=document.createElement("button");
b.textContent=n;
b.onclick=()=>pickNumber(n);
$("nums").appendChild(b);
}
}
}

function setMode(m){
state.mode=m;
}

$("mS").onclick=()=>setMode("S");
$("mD").onclick=()=>setMode("D");
$("mT").onclick=()=>setMode("T");

function pickNumber(n){

let mult=state.mode;
let pts=n;
let isDouble=false;
let label="S"+n;

if(mult==="D"){pts=n*2;isDouble=true;label="D"+n;}
if(mult==="T"){pts=n*3;label="T"+n;}

pushDart({label,points:pts,isDouble});

}

function pickSpecial(v){
pushDart({label:v,points:v,isDouble:v===50});
}

function pushDart(obj){

if(state.dartIdx>2) return;

state.darts[state.dartIdx]=obj;
state.dartIdx++;

state.mode="S";

renderKeypad();

if(state.autoOk && state.dartIdx===3){
submitTurn();
}
}

function undoDart(){
if(state.dartIdx===0) return;
state.dartIdx--;
state.darts[state.dartIdx]=null;
renderKeypad();
}

function clearTurn(){
resetTurn();
renderKeypad();
}

function nextPlayer(){
state.current=(state.current+1)%state.players.length;
resetTurn();
}

function submitTurn(){

let p=state.players[state.current];

let total=state.darts.reduce((s,d)=>s+(d?.points||0),0);

let newScore=p.score-total;

if(newScore<0 || (state.doubleOut && newScore===1)){
nextPlayer();
renderAll();
return;
}

if(newScore===0){

if(state.doubleOut){
let last=state.darts[2];
if(!last?.isDouble){
nextPlayer();
renderAll();
return;
}
}

p.score=0;
p.won=true;
nextPlayer();
renderAll();
return;
}

p.score=newScore;
nextPlayer();
renderAll();
}

$("startBtn").onclick=startGame;

$("randomStartBtn").onclick=()=>{
state.current=Math.floor(Math.random()*state.players.length);
renderAll();
};

$("undoBtn").onclick=()=>startGame();

startGame();

</script>

</body>
</html>
